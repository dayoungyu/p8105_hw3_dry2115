p8105\_hw3\_dry2115
================
Dayoung Yu
2018-10-15

Problem 1
---------

Read and clean brfss\_smart2010 data:

``` r
library(p8105.datasets)

brfss_df = as.tibble(
  brfss_smart2010 %>%
  janitor::clean_names() %>%
  rename(state = locationabbr, county = locationdesc) %>%
  filter(topic == "Overall Health") %>%
  mutate(response = factor(response, levels = c("Excellent", "Very good", "Good", "Fair", "Poor"))) %>%
  arrange(response)
)
```

Find states that were observed at 7 locations:

``` r
brfss_df %>%
  filter(year == 2002) %>%
  group_by(state) %>%
  summarize(n_locations = n_distinct(county)) %>%
  filter(n_locations == 7) %>%
  knitr::kable()
```

| state |  n\_locations|
|:------|-------------:|
| CT    |             7|
| FL    |             7|
| NC    |             7|

Connecticut, Florida, and North Carolina were observed at 7 locations.

Spaghetti plot that shows the number of locations at each state from 2002 to 2010:

``` r
brfss_df %>%
  filter(year %in% (2002:2010)) %>%
  group_by(state, year) %>%
  summarize(n_locations = n_distinct(county)) %>%

  ggplot(aes(x = year, y = n_locations, color = state)) +
    geom_smooth(se = FALSE) +
    theme(legend.position = "none") +
    labs(
      title = "Number of Distinct Locations by State in 2002-2010",
      x = "Year",
      y = "N distinct locations"
    )
```

<img src="p8103_hw3_dry2115_files/figure-markdown_github/unnamed-chunk-3-1.png" width="90%" />

Proportion of "Excellent" responses in NY locations in 2002, 2006, and 2010:

``` r
brfss_df %>%
    filter(state == "NY", response == "Excellent", year %in% c(2002, 2006, 2010)) %>%
    group_by(year) %>%
    summarize(mean_prop = mean(data_value), sd_prop = sd(data_value)) %>%
    knitr::kable(digits = 1)
```

|  year|  mean\_prop|  sd\_prop|
|-----:|-----------:|---------:|
|  2002|        24.0|       4.5|
|  2006|        22.5|       4.0|
|  2010|        22.7|       3.6|

Compute average proportions in each response category for each state and year:

``` r
brfss_df %>%
  group_by(response, year, state) %>%
  summarize(mean_prop = mean(data_value)) %>%
  
  ggplot(aes(x = year, y = mean_prop, color = state)) +
  geom_smooth(se = FALSE) + 
  facet_grid(~response) +
  theme(legend.position = "none") +
  theme(axis.text.x = element_text(angle = 45)) +
  labs(
      x = "Year",
      y = "Mean proportion of response"
    )
```

<img src="p8103_hw3_dry2115_files/figure-markdown_github/unnamed-chunk-5-1.png" width="90%" />

Problem 2
---------

``` r
instacart_aisles = (instacart %>%
  group_by(aisle) %>%
  summarize(n_items = n()) %>%
  arrange(desc(n_items)))
```

There are 134 distinct aisles.The top three aisles from which items are ordered are "fresh vegetables", "fresh fruits", and "packaged vegetables fruits".

Plot of the number of items ordered in each aisle:

``` r
instacart %>%
  group_by(department) %>%
  
ggplot(aes(x = aisle)) +
  geom_bar() + 
  coord_flip() 
```

<img src="p8103_hw3_dry2115_files/figure-markdown_github/unnamed-chunk-7-1.png" width="90%" />

Table of most popular items in “baking ingredients”, “dog food care”, and “packaged vegetables fruits”.

``` r
instacart %>%
  filter(aisle == c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  group_by(aisle, product_name) %>%
  summarize(n_items = n()) %>%
  summarize(n_max = max(n_items))
```

    ## # A tibble: 3 x 2
    ##   aisle                      n_max
    ##   <chr>                      <dbl>
    ## 1 baking ingredients           157
    ## 2 dog food care                 14
    ## 3 packaged vegetables fruits  3324

``` r
### How to join with item name
```

Table showing the mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week:

``` r
instacart %>%
  filter(product_name == c("Pink Lady Apples", "Coffee Ice Cream")) %>% 
  group_by(product_name, order_dow) %>%
  summarize(mean_hour = mean(order_hour_of_day)) %>%
  mutate(mean_hour = paste(floor(mean_hour), 
                    sprintf("%02.0f",(round((mean_hour - floor(mean_hour))*60))), 
                    sep = ":")) %>%
  spread(key = order_dow, value = mean_hour) %>%
  rename(Sun = '0', Mon = '1', Tues = '2', Wed = '3', Thur = '4', Fri = '5', Sat = '6') %>%
  knitr::kable()
```

    ## Warning in product_name == c("Pink Lady Apples", "Coffee Ice Cream"):
    ## longer object length is not a multiple of shorter object length

| product\_name    | Sun   | Mon   | Tues  | Wed   | Thur  | Fri   | Sat   |
|:-----------------|:------|:------|:------|:------|:------|:------|:------|
| Coffee Ice Cream | 13:13 | 15:00 | 15:20 | 15:24 | 15:10 | 10:20 | 12:21 |
| Pink Lady Apples | 12:15 | 11:41 | 12:00 | 13:56 | 11:55 | 13:52 | 11:33 |

Problem 3
---------
