---
title: "p8105_hw3_dry2115"
author: "Dayoung Yu"
date: 2018-10-15
output: github_document
---


```{r setup, include=FALSE}
library(tidyverse)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_bw() + theme(legend.position = "bottom"))
```

## Problem 1

Read and clean brfss_smart2010 data:

```{r}
library(p8105.datasets)

brfss_df = as.tibble(
  brfss_smart2010 %>%
  janitor::clean_names() %>%
  rename(state = locationabbr, county = locationdesc) %>%
  filter(topic == "Overall Health") %>%
  mutate(response = factor(response, levels = c("Excellent", "Very good", "Good", "Fair", "Poor"))) %>%
  arrange(response)
)

```

Find states that were observed at 7 locations:

```{r}
brfss_df %>%
  filter(year == 2002) %>%
  group_by(state) %>%
  summarize(n_locations = n_distinct(county)) %>%
  filter(n_locations == 7) %>%
  knitr::kable()
```

Connecticut, Florida, and North Carolina were observed at 7 locations.


Spaghetti plot that shows the number of locations at each state from 2002 to 2010:

```{r}

brfss_df %>%
  filter(year %in% (2002:2010)) %>%
  group_by(state, year) %>%
  summarize(n_locations = n_distinct(county)) %>%

  ggplot(aes(x = year, y = n_locations, color = state)) +
    geom_smooth(se = FALSE) +
    theme(legend.position = "none") +
    labs(
      title = "Number of Distinct Locations by State in 2002-2010",
      x = "Year",
      y = "N distinct locations"
    )
  
```

Proportion of "Excellent" responses in NY locations in 2002, 2006, and 2010:

```{r}

brfss_df %>%
    filter(state == "NY", response == "Excellent", year %in% c(2002, 2006, 2010)) %>%
    group_by(year) %>%
    summarize(mean_prop = mean(data_value), sd_prop = sd(data_value)) %>%
    knitr::kable(digits = 1)

                
```


Compute average proportions in each response category for each state and year: 

```{r}
brfss_df %>%
  group_by(response, year, state) %>%
  summarize(mean_prop = mean(data_value)) %>%
  
  ggplot(aes(x = year, y = mean_prop, color = state)) +
  geom_smooth(se = FALSE) + 
  facet_grid(~response) +
  theme(legend.position = "none")
```


## Problem 2

```{r}


```


## Problem 3

```{r}


```

